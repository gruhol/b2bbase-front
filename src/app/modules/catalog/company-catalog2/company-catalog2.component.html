<div class="container">
    <div class="row">
        <div class="col-3 border rounded-1 shadow-sm bg-light-subtle p-4 mr-1 mb-3">
            <h3>Kategorie:</h3>
            <p>
                <label>Filter by:
                <input [(ngModel)]="searchString" />
                </label>
                <mat-slide-toggle class="toggle-show-only-selected" [(ngModel)]="showOnlySelected">Show only selected</mat-slide-toggle>
            </p>
            <mat-tree [dataSource]="categoryDataSource" [treeControl]="treeControl" class="example-tree">
                <!-- This is the tree node template for leaf nodes -->
                <mat-tree-node 
                *matTreeNodeDef="let node" 
                matTreeNodeToggle
                [style.display]="showOnlySelected && !node.selected || this.searchString && hideLeafNode(node) ? 'none' : 'block'">
                <li class="mat-tree-node">
                    <mat-checkbox class="checklist-leaf-node" (change)="itemToggle($event.checked,node)" [checked]="node.selected">{{node.name}}</mat-checkbox>
                </li>
                </mat-tree-node>
            
                <mat-nested-tree-node 
                *matTreeNodeDef="let node; when: hasChild"
                [style.display]="(showOnlySelected && !(node.selected || node.indeterminate)) || this.searchString && hideParentNode(node) ? 'none' : 'block'">
                <li>
                    <div class="mat-tree-node">
                    <button mat-icon-button matTreeNodeToggle
                            [attr.aria-label]="'toggle ' + node.name">
                        <mat-icon class="mat-icon-rtl-mirror">
                        {{treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}
                        </mat-icon>
                    </button>
                        <mat-checkbox [checked]="node.selected"
                                [indeterminate]="node.indeterminate && !node.selected"
                                (change)="itemToggle($event.checked,node)">{{node.name}}</mat-checkbox>
                    </div>
                    <ul [class.example-tree-invisible]="!treeControl.isExpanded(node)">
                    <ng-container matTreeNodeOutlet></ng-container>
                    </ul>
                </li>
                </mat-nested-tree-node>
            </mat-tree>
        </div>
        <div class="col-9">
            <div *ngFor="let company of page?.content" class="ms-3">
                <div class="w-100 border rounded-1 shadow-sm bg-light-subtle p-4 mr-1 mb-3">
                    <div class="row">
                        <div class="col-10">
                            <h3>{{company.name}}</h3>
                            <p>{{company.nip}}</p>
                        </div>
                        <div class="col-2">
                            <img *ngIf="company.logo" src="{{'/api/img/get/logos/' + company.logo}}" class="img-thumbnail">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <mat-paginator *ngIf="page && page.totalElements > 0"
        [length]="page.totalElements"
        [pageSize]="5"
        [pageSizeOptions]="[5, 10, 25]"
        aria-label="Wybierz stronÄ™"
        (page)="onPageEvent($event)">
    </mat-paginator>
</div>